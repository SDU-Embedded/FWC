#     This file is autogenerated by FWC - Changes will be overwritten
UNPRIV=1024:65000;

# Start in a known state

for A in filter nat mangle raw; do
        iptables -t $A -F
        iptables -t $A -X
        iptables -t $A -Z
done


#sudo iptables -I INPUT -p tcp  -s 10.10.10.0/24 -d 10.10.10.1/32 --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT
#sudo iptables -I OUTPUT -p tcp -s 10.10.10.1/32 -d 10.10.10.0/24 --sport 22 -m state --state ESTABLISHED -j ACCEPT

sudo iptables -t nat -A POSTROUTING -o world -j MASQUERADE

#iptables -t nat -A PREROUTING -p tcp -d 10.10.10.1 --dport 22 -j DNAT --to-destination 169.254.0.1

# Allow all loopback traffic
iptables -A INPUT  -i lo -j ACCEPT
iptables -A OUTPUT -o lo -j ACCEPT


echo "1" > /proc/sys/net/ipv6/conf/all/disable_ipv6                # No IPv6
echo "1" > /proc/sys/net/ipv4/tcp_syncookies
echo "0" > /proc/sys/net/ipv4/icmp_echo_ignore_all
echo "1" > /proc/sys/net/ipv4/icmp_echo_ignore_broadcasts
echo "0" > /proc/sys/net/ipv4/conf/all/accept_source_route
echo "0" > /proc/sys/net/ipv4/conf/all/accept_redirects
echo "1" > /proc/sys/net/ipv4/icmp_ignore_bogus_error_responses
for interface in /proc/sys/net/ipv4/conf/*/rp_filter; do
    echo "1" > ${interface}
done
echo "1" > /proc/sys/net/ipv4/conf/all/log_martians
echo "0" > /proc/sys/net/ipv4/ip_forward

